<div class="form-control">
  <label for="{{ form.name.id_for_label }}">
    <span class="label-text">{{ form.name.label }}</span>
  </label>
  {{ form.name }}
  <label class="text-error">{{ form.name.errors }}</label>
</div>
<div class="form-control">
  <label for = "{{ form.type.id_for_label }}">
    <span class="label-text">{{ form.type.label }}</span>
  </label>
  {{ form.type }}
  <label class="text-error">{{ form.type.errors }}</label>
</div>
<div class="form-control question1">
  <label for="question-1">
    <span class="label-text">Question</span>
  </label>
  <textarea id="question-1" name="question1" class="md:col-span-2 row-span-1 grow" required></textarea> 
  <label class="text-error">{{ form.questions.errors }}</label>
  <div class="form-control">
    <label for = "figure1">
      <span class="label-text">Figure</span>
    </label>
    <input type="file" name="question_figure" id="question_figure">
    <label class="text-error">{{ form.questions.figure.errors }}</label>
    <button type="button" class="btn btn-error text-white mt-6" id="question1" onclick="handleRemoveQuestion(this)"><i class="far fa-trash-alt"></i>Remove Question</button>
  </div>
  <div class="form-control" id="q1">
    <button class="btn btn-primary text-white mt-6" onclick="handleAddChoice(this)" type="button">
      <i class="far fa-plus"></i>Add choice</button>
      
    </div>
  </div>
  <button type="button" class="btn bg-gradient-to-br from-purple-600 to-pink-400 text-white px-12 border-0 shadow-md shadow-purple-500/50 mt-8" onclick="handleAddQuestion(this)"><i class="far fa-plus"></i>Add Question</button>
  <p>Total Questions:<span id="question-count">1</span></p>
<script>
  function addHTMLBeforeElement(htmlContent, targetElement) {
  if (targetElement && targetElement.insertAdjacentHTML) {
    targetElement.insertAdjacentHTML('beforebegin', htmlContent);
  }
}
  let question_number = 1;
  function handleAddChoice(e){
    console.log(e);
    const choiceQuestionNumber = (e.parentNode.id).slice(1);
   const choiceHtml = `
   <div class='mt-3' data-question-number="${question_number}">
    <input type='text' name="choice${choiceQuestionNumber}" placeholder='Enter Choice Value' required>
    <div class='flex mt-2'><input name="is_correct-${choiceQuestionNumber}" type='checkbox' id='is_checked'>
    <label for='is_checked'>Correct</label>
    <button type="button"  class="btn btn-sm btn-error btn-square mt-2.9" onClick="handleRemoveChoice(this)"><i class="far fa-trash-alt"></i>
    </div>
    </div>
    `
    addHTMLBeforeElement(choiceHtml, e);
  }
  function handleRemoveQuestion(e){
    const remove_class = e.id;
    const remove_element=document.getElementsByClassName(remove_class);
    console.log(remove_element[0]);
    remove_element[0].remove();
    question_number--;
    document.getElementById('question-count').innerText = question_number;
  }
  function handleAddQuestion(e){
    question_number++;
    const questionHtml = `
    <div class="form-control question${question_number}">
  <label for="question-${question_number}">
    <span class="label-text">Question</span>
  </label>
  <textarea id="question-${question_number}" name="question${question_number}" class="md:col-span-2 row-span-1 grow" required></textarea> 
  <label class="text-error">{{ form.questions.errors }}</label>
  <div class="form-control">
    <label for ="figure${question_number}">
      <span class="label-text">Figure</span>
    </label>
    <input type="file" name="question_figure" id="question_figure">
    <label class="text-error">{{ form.questions.figure.errors }}</label>
    <button type="button" class="btn btn-error text-white mt-6" id="question${question_number}" onclick="handleRemoveQuestion(this)"><i class="far fa-trash-alt"></i>Remove Question</button>
  </div>
  <div id="choices" class="form-control"></div>
  <div class="form-control" id="q${question_number}"">
    <button class="btn btn-primary text-white mt-6" id="test_add" onclick="handleAddChoice(this)" type="button">
      <i class="far fa-plus"></i>Add choice</button>
    </div>
  </div>
    `
    addHTMLBeforeElement(questionHtml, e);
    document.getElementById('question-count').innerText = question_number;
    
  }
  function handleRemoveChoice(e){
    e.parentNode.parentNode.remove();
  }
</script>
